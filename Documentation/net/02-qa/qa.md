# 网络相关问答

## Linux 网卡是如何工作的

网卡设备是通过网络接口卡(NIC)来实现的。网卡是计算机连接到网络的物理接口，它负责接收和发送数据包。

网卡设备的工作分为以下几个主要步骤：
1. 设备驱动程序加载：当计算机启动时候，操作系统会加载与网卡设备对应的驱动程序。这个驱动程序负责与硬件进行通信，并将设备表示为一个字符设备文件，例如：`/dev/eth0`
2. 网络配置：在设备驱动程序加载后，可以通过网络配置工具（如：ifconfig 或 ip 命令）对网卡进行配置。这包括设置 ip地址、子网掩码、网关等参数。
3. 数据包接收：当计算机接收到一个数据包时候，网卡设备会将数据包传输到内存中的接收缓存区。网卡设备会通过中断或者直接内存访问（DMA）方式将数据包复制到内存中。
4. 数据包处理：一旦数据包被复制到内存中，操作系统的网络协议栈将对其进行处理。这包括根据协议（如：TCP/IP）解析包头、检查校验和、进行路由选择等操作。根据目标IP地址，操作系统会决定将数据报传递给哪个进程或应用程序。
5. 数据报发送：当应用程序发送一个数据包时，操作系统会将数据包传递给网卡设备。网卡设备将数据包复制到发送缓存区，并通过DMA方式将数据包发送到网络中。
6. 中断处理：网卡设备在接收或发送数据包完成后会触发一个中断，通知操作系统有数据包需要处理。操作系统将调用相应的中断处理程序来处理这些中断。

## DPDK 是如何应用于网卡的

DPDK 是一个开源软件开发套件，旨在加速数据平面应用程序的开发和执行。它主要用于在高性能网络应用中利用网络接口卡（NIC）的硬件功能。

DPDK 通过绕过操作系统内核，在用户空间直接访问网卡硬件，从而降低了数据报处理的延迟，并提高了数据报处理的吞吐量。

下面是DPDK应用于网卡的一般工作流程：
1. 初始化：首先，应用程序需要初始化DPDK库，包括配置内存、初始化设备、创建处理线程等。这通常在应用程序启动时候完成。
2. 网卡绑定：应用程序需要将网卡绑定到DPDK驱动程序，以便DPDK可以直接访问当卡硬件。这通常通过将网卡驱动程序替换为DPDK提供的驱动程序来实现。
3. 数据包接收：应用程序使用 DPDK 提供的接口来接收网卡队列中的数据包，并将它们存储在应用程序指定的内存缓存区中
4. 数据包处理：一旦数据报被接收到应用程序的内存缓存区中，应用程序可以对数据包进行处理。这包括解析数据包头部、执行网络协议处理、进行数据包过滤、执行数据包转发等操作。由于 DPDK 在用户空间执行，避免了操作系统内核的开销，从而提高了数据报处理的性能。
5. 数据包发送：应用程序使用 DPDK 提供的接口将处理后的数据包发送到网卡发送队列。DPDK将数据包复制到网卡的发送缓存区，并通过DMA方式发送到网络中。
6. 释放资源：应用程序在完成数据包处理后，需要进行资源的清理和释放，包括释放内存、关闭设备等。

## 网络相关设备

1. 网卡（NIC）：将计算机连接到网络的设备。它实现计算机数据包 与 网络数据 转换。                             —— 物理层
2. 交换机（Switch）：将多个设备连接到一个网络上的设备，它根据MAC地址将数据包转发到相应的设备。              —— 数据链路层
3. 路由器（Router）：路由器是一种将多个网络连接到一起的设备，它根据IP地址将数据包转发到相应的网络。         —— 网络层
4. 网关（Gateway）：网关是一种将局域网络连接到广域网络（WAN）或互联网的设备。                               —— 网络层
5. Wi-Fi接入点（AP）：Wi-Fi接入点是一种将无线网络连接到局域网络的设备。                                     —— 数据链路层
6. 网络桥（Bridge）：网络桥是一种将两个或多个网络连接到一起的设备，它将数据包转发到相应的网络。             —— 数据链路层
7. 网络集线器（Hub）：是一种将多个设备连接到一个网络上的设备，它将数据包广播到所有连接到它的设备。          —— 物理层
8. 网络防火墙（Firewall）：是一种监控和控制进出网络的设备，它根据预先设定的安全规则来允许或拒绝网络流量。   —— 网络层
9. VPN服务器（VPN Server）：是一种将数据包加密并将其发送到互联网的设备，以便在互联网上进行安全通信。        —— 网络层
10. 光猫（Modem）：用于让计算机连接到互联网。                                                               —— 物理层
11. 代理服务器（Proxy Server）：                                                                            —— 应用层

> DPDK 工作在 OSI 的数据链路层

## 计算机接入互联网的必要设备

1. 网络接口卡（NIC）：允许计算机连接到网络的设备。有线 或 无线 NIC。
2. 路由器：这个设备将流量指向计算机和互联网之间。它连接到你的互联网服务提供商（ISP），并提供了一个网络门户，让你的计算机访问互联网。
3. 光猫：这个设备将计算机连接到你的互联网服务提供商（ISP）。它将数据从你的计算机转换成可以在互联网上传输的格式，并将互联网上的数据转换回来，以便计算机可以访问互联网。
4. 交换机：这个设备将多个设备在同一个局域网中连接起来。它将流量寄给正确的目的地，以确保数据能够正确的在设备之间传输。
5. 无线接入点（AP）：如果你有一个无线网络，你需要一个无线AP来连接你的计算机到互联网。无线AP将无线信号发送到你的计算机，以便你的计算机可以无线访问互联网。
6. Ethernet电缆：这个电缆将你的计算机连接到路由器或交换机，提供有限连接到网络。

网卡 --> 路由器（内置网络管理，即网关的功能、内置防火墙、VPN、访问控制列表ACL等） -->  光猫（连接到ISP）

### 光猫

光猫用于将光前接入网络。光猫的作用是将光纤信号转换为电信号，以便连接到用户的路由器或计算机。

光猫通常由网络服务提供商（ISP）提供。

并不是所有的网络中都需要光猫。在使用其它类型的网络连接（如：电缆、DSL等）无须使用光猫。

### 光猫和电缆调制解调器区别

#### 光猫（ONT）工作原理

光猫是用于光纤接入网络的设备。它的主要功能是将光纤传输的光信号转换为电信号，以便连接到用户的路由器或计算机，工作过程如下：
- 光纤信号到达光猫，经过光电转换器将光信号转换为电信号
- 转换后的电信号通过以太网端口或其它接口传输给用户的设备，例如：路由器。
- 用户设备接收到电信号后，可以通过路由器进行网络通信，连接到互联网。

#### 电缆调制解调器（Cable Modem）工作原理

电缆调制解调器是用于有线电视网络（Cable Internet）的设备。它的主要功能是将有限电视信号中的互联网数据解调，并将用户的数据传输回网络提供商。工作过程如下：
- 有线电视信号中包含了互联网数据，电缆调制解调器通过电缆线接收这个信号。
- 调制解调器将有线电视信号解调，提取出互联网数据
- 提取出的互联网数据通过以太网端口或其它接口传输给用户的设备，例如：路由器。
- 用户设备接收到互联网数据后，可以通过路由器进行网络通信，连接到互联网

#### 光猫和有限网络区别

- 光猫用于光纤接入网络，而电缆调制解调器主要用于有线电视网络
- 光猫将光纤信号转为电信号，而电缆调制解调器将有线电视信号调制为互联网数据
- 光猫通常由光纤网络服务提供商提供，而电缆调制解调器通常由有线电视网络服务提供商提供
- 光猫连接到用户设备的方式通常是通过以太网，而电缆调制解调器可以通过同样的方式或者通过电缆线连接

### 调制与解调的工作原理

调制和解调是将信号转换为适合传输或适合处理的形式的过程。

调制将数字或模拟信号转换为调试信号，解调则将调制信号还原为原始信号。

以下是调制和解调的基本工作原理：
- 数字调制：在数字调制中，将数字信号转换为模拟信号的形式来传输。常见的数字调制方法包括：
    - Amplitude Shift Keying（ASK）：使用不同的幅度表示数字信号的不同值
    - Frequency Shift Keying（FSK）：使用不同的频率来表示数字信号的不同值
    - Phase Shift Keying（PSK）：使用不同的相位来表示数字信号的不同值
- 模拟调制：在模拟调制中，将模拟信号转换为调制信号进行传输。常见的模拟调制方法包括：
    - Amplitude Modulation（AM）：将模拟信号的幅度变化与调制信号进行乘积，得到调制后的信号
    - Frequency Modulation（FM）：将模拟信号的频率变化与调制信号进行加减，得到调制后的信号。
    - Phase Modulation（PM）：将模拟信号的相位变化与调制信号进行加减，得到调制后的信号。

解调的工作原理：
- 数字解调：在数字解调中，将调制信号转换回数字信号的形式。解调过程通常与调制过程相反，使用相应的解调方法，如 ASK 解调器、FSK解调器或 PSK 解调器。
- 模拟解调：在模拟解调中，将模拟信号转换回模拟信号的形式。解调过程通常与调制过程相反，使用相应的解调方法，如AM解调器、FM解调器、PM解调器

调制和解调的目的是在信号传输过程中保持信号的完整性和准确性。调制将信号转换为合适传输的形式，解调将信号从调制形式还原为原始形式，以便接收方能正确理解和处理信号。这些过程在各种通信系统和传输介质中都得到广泛应用。


